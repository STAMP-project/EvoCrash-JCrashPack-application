java.lang.UnsupportedOperationException: query must be rewritten first
    at org.elasticsearch.index.query.GeoShapeQueryBuilder.doToQuery(GeoShapeQueryBuilder.java:317)
    at org.elasticsearch.index.query.AbstractQueryBuilder.toQuery(AbstractQueryBuilder.java:96)
    at org.elasticsearch.index.query.BoolQueryBuilder.addBooleanClauses(BoolQueryBuilder.java:442)
    at org.elasticsearch.index.query.BoolQueryBuilder.doToQuery(BoolQueryBuilder.java:418)
    at org.elasticsearch.index.query.AbstractQueryBuilder.toQuery(AbstractQueryBuilder.java:96)
    at org.elasticsearch.index.query.AbstractQueryBuilder.toFilter(AbstractQueryBuilder.java:118)
    at org.elasticsearch.index.query.BoolQueryBuilder.addBooleanClauses(BoolQueryBuilder.java:446)
    at org.elasticsearch.index.query.BoolQueryBuilder.doToQuery(BoolQueryBuilder.java:419)
    at org.elasticsearch.index.query.AbstractQueryBuilder.toQuery(AbstractQueryBuilder.java:96)
    at org.elasticsearch.percolator.PercolatorFieldMapper.toQuery(PercolatorFieldMapper.java:343)
    at org.elasticsearch.percolator.PercolatorFieldMapper.parseQuery(PercolatorFieldMapper.java:325)
    at org.elasticsearch.percolator.PercolateQueryBuilder.lambda$null$3(PercolateQueryBuilder.java:547)
    at org.elasticsearch.percolator.PercolateQuery$1$2.matchDocId(PercolateQuery.java:170)
    at org.elasticsearch.percolator.PercolateQuery$BaseScorer$1.matches(PercolateQuery.java:256)
    at org.apache.lucene.search.ConjunctionDISI$ConjunctionTwoPhaseIterator.matches(ConjunctionDISI.java:345)
    at org.apache.lucene.search.Weight$DefaultBulkScorer.scoreAll(Weight.java:228)
    at org.apache.lucene.search.Weight$DefaultBulkScorer.score(Weight.java:172)
    at org.apache.lucene.search.BulkScorer.score(BulkScorer.java:39)
    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:669)
    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:473)
    at org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:397)
    at org.elasticsearch.search.query.QueryPhase.execute(QueryPhase.java:108)
    at org.elasticsearch.search.SearchService.loadOrExecuteQueryPhase(SearchService.java:247)
    at org.elasticsearch.search.SearchService.executeQueryPhase(SearchService.java:261)
    at org.elasticsearch.action.search.SearchTransportService$6.messageReceived(SearchTransportService.java:331)
    at org.elasticsearch.action.search.SearchTransportService$6.messageReceived(SearchTransportService.java:328)
    at org.elasticsearch.transport.RequestHandlerRegistry.processMessageReceived(RequestHandlerRegistry.java:69)
    at org.elasticsearch.transport.TransportService$7.doRun(TransportService.java:618) ~[elasticsearch-5.3.2.jar:5.3.2]
    at org.elasticsearch.common.util.concurrent.ThreadContext$ContextPreservingAbstractRunnable.doRun(ThreadContext.java:638)
    at org.elasticsearch.common.util.concurrent.AbstractRunnable.run(AbstractRunnable.java:37)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
    at java.lang.Thread.run(Thread.java:748)
